<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Deals - Bintech CRM</title>
  <link rel="stylesheet" href="styles.css"/>
  <style>
  :root {
    --primary: #2c3e50;
    --accent: #3498db;
    --light-gray: #ecf0f1;
    --success: #28a745;
    --danger: #dc3545;
    --info: #17a2b8;
    --warning: #f39c12;
  }

  body {
    display: flex;
    min-height: 100vh;
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #f0f6fc;
  }

  .sidebar {
    width: 220px;
    background-color: var(--primary);
    color: white;
    padding: 20px;
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
  }

  .main-content {
    margin-left: 220px;
    padding: 20px 40px;
    width: calc(100% - 220px);
    background-color: #f9f9f9;
  }

  .sidebar h2 {
    text-align: center;
    margin-bottom: 30px;
    font-size: 22px;
  }

  .sidebar ul {
    list-style: none;
    padding: 0;
  }

  .sidebar ul li {
    margin: 20px 0;
  }

  .sidebar ul li a {
    color: white;
    text-decoration: none;
    font-size: 16px;
  }

  .sidebar ul li a.active,
  .sidebar ul li a:hover {
    text-decoration: underline;
    color: var(--accent);
  }

  .navbar {
    display: flex;
    justify-content: space-between;
    background-color: var(--accent);
    padding: 10px 20px;
    color: white;
    border-radius: 6px;
    margin-bottom: 20px;
  }

  .navbar .nav-links {
    display: flex;
    gap: 15px;
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .navbar a {
    color: white;
    text-decoration: none;
  }

  .navbar .dark-toggle {
    background: transparent;
    border: 1px solid white;
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
  }

  h1 {
    margin-bottom: 10px;
    color: #0a66c2;
  }

  #dealContainer {
    background-color: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
    max-width: 100%;
  }

  form h2 {
    margin-bottom: 15px;
    color: var(--primary);
  }

  .form-row {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-width: 250px;
  }

 .form-group label {
  font-weight: bold;
  margin-bottom: 6px;
  color: #0a66c2; /* Same blue as in Leads page */
}


  form input,
  form select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    margin-bottom: 10px;
    font-size: 14px;
    font-weight: bold; 
  }

  form button {
    background-color: var(--accent);
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px;
    transition: background-color 0.3s ease;
  }

  form button:hover {
    background-color: #2874b0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 30px;
    background-color: white;
    border-radius: 8px;
    overflow: hidden;
  }

  table thead {
    background-color: var(--primary);
    color: white;
  }
table th {
      background-color: #e8f0fe;
      color: #0a66c2;
    }
  table td {
    padding: 12px 10px;
    border: 1px solid #ccc;
    text-align: left;
    font-size: 14px;
  }

  .stage-tag {
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 13px;
    color: white;
    display: inline-block;
  }

  .Negotiation {
    background-color: #370b9e;
  }

  .Proposal {
    background-color: var(--info);
  }

  .Closed\ Won {
    background-color: var(--success);
  }

  .Closed\ Lost {
    background-color: var(--danger);
  }

  .action-buttons {
    display: flex;
    gap: 8px;
  }

  .action-buttons button {
    padding: 6px 12px;
    font-size: 13px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: opacity 0.2s ease;
  }

  .edit-btn {
    background-color: var(--accent);
    color: white;
  }

  .edit-btn:hover {
    opacity: 0.85;
  }

  .delete-btn {
    background-color: var(--danger);
    color: white;
  }

  .delete-btn:hover {
    opacity: 0.85;
  }

  /* Responsive Enhancement */
  @media screen and (max-width: 768px) {
    .form-row {
      flex-direction: column;
    }

    .main-content {
      padding: 20px;
    }
  }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

</head>
<body>
  <div class="sidebar">
    <h2>üìä CRM</h2>
    <ul>
      <li><a href="index.html">Dashboard</a></li>
      <li><a href="leads.html">Leads</a></li>
      <li><a class="active" href="deals.html">Deals</a></li>
      <li><a href="contacts.html">Contacts</a></li>
    </ul>
  </div>

  <div class="main-content">
    <nav class="navbar">
      <div class="nav-brand">üîπ Bintech CRM</div>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="leads.html">Leads</a></li>
        <li><a href="deals.html">Deals</a></li>
        <li><a href="contacts.html">Contacts</a></li>
      </ul>
      <button class="dark-toggle" onclick="document.body.classList.toggle('dark-mode')">üåô</button>
    </nav>

    <h1>Deals</h1>
    <div id="customerDetails" style="margin-bottom: 20px; font-weight: bold;"></div>

    <div id="dealContainer">
      <form id="dealForm">
      <h2>Add a New Deal</h2>

  <div class="form-row">
    <div class="form-group">
      <label for="dealName">Deal Name</label>
      <input type="text" id="dealName" placeholder="Deal Name" required />
    </div>
    <div class="form-group">
      <label for="dealAmount">Amount (Ksh)</label>
      <input type="number" id="dealAmount" placeholder="Amount (Ksh)" required />
    </div>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="dealStage">Deal Stage</label>
      <select id="dealStage" required>
        <option value="">Select Stage</option>
        <option value="Negotiation">Negotiation</option>
        <option value="Proposal">Proposal</option>
        <option value="Closed Won">Closed Won</option>
        <option value="Closed Lost">Closed Lost</option>
      </select>
    </div>
    <div class="form-group">
      <label for="customerNumberInput">Customer Number</label>
      <input type="text" id="customerNumberInput" name="customerNumber" />
    </div>
    <div class="form-group">
      <label for="inquiryDateInput">Inquiry Date</label>
      <input type="text" id="inquiryDateInput" name="inquiryDate" />
    </div>
  </div>
  <div class="form-row">
    <div class="form-group">
      <label for="customerNameInput">Customer Name</label>
      <input type="text" id="customerNameInput" name="customerName" />
    </div>
    <div class="form-group">
      <label for="companyNameInput">Company Name</label>
      <input type="text" id="companyNameInput" name="company" />
    </div>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="emailInput">Email</label>
      <input type="email" id="emailInput" name="email" />
    </div>
    <div class="form-group">
      <label for="phoneInput">Phone</label>
      <input type="tel" id="phoneInput" name="phone" />
    </div>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="sourceInput">Source</label>
      <input type="text" id="sourceInput" name="source" />
    </div>
    <div class="form-group">
      <label for="productInput">Product</label>
      <input type="text" id="productInput" name="product" />
    </div>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="brandInput">Brand</label>
      <input type="text" id="brandInput" name="brand" />
    </div>
    <div class="form-group">
  <label for="followUpPhoneInput">Follow Up on Phone</label>
 <input type="text" class="flatpickr-datetime" id="followUpPhoneInput">
</div>
<div class="form-group">
  <label for="followUpEmailInput">Follow Up on Email</label>
  <input type="text" class="flatpickr-datetime" id="followUpEmailInput">
</div>
<div class="form-group">
  <label for="quotationDateInput">Quotation Date</label>
  <input type="text" class="quotationDateInput" id="quotationDate" />
</div>
  </div>
  <div style="text-align: right; margin-top: 20px;">
    <button type="submit">‚ûï Add Deal</button>
  </div>
</form>

      <!-- CSV Import/Export Section -->
      <div style="margin: 30px 0; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
        <h3 style="margin-bottom: 15px; color: var(--primary);">üìÅ Import/Export Data</h3>
        
        <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
          <!-- File Import -->
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="file" id="csvFileInput" accept=".csv" style="display: none;" />
            <button type="button" onclick="document.getElementById('csvFileInput').click()" 
                    style="background-color: var(--success); color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
              üìÇ Choose CSV File
            </button>
            <button type="button" id="importBtn" onclick="importCSV()" disabled="true"
                    style="background-color: var(--info); color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; opacity: 0.6;">
              üì• Import CSV
            </button>
          </div>
          
          <!-- File Export -->
          <button type="button" onclick="exportCSV()" 
                  style="background-color: var(--warning); color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
            üì§ Export to CSV
          </button>
          
          <!-- Clear All Data -->
          <button type="button" onclick="clearAllDeals()" 
                  style="background-color: var(--danger); color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
            üóëÔ∏è Clear All Data
          </button>
        </div>
        
        <div id="fileInfo" style="margin-top: 10px; font-size: 13px; color: #666;"></div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Deal</th>
            <th>Customer Number</th>
            <th>Inquiry Date</th>
            <th>Amount</th>
            <th>Stage</th>
            <th>Customer</th>
            <th>Company</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Source</th>
            <th>Product</th>
            <th>Brand</th>
            <th>Follow Up (Phone)</th>         
            <th>Follow Up (Email)</th>         
            <th>Quotation Date</th>    
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="dealTableBody"></tbody>
      </table>
    </div>
  </div>

  <script>
  const dealForm = document.getElementById("dealForm");
  const dealTableBody = document.getElementById("dealTableBody");
  let deals = JSON.parse(localStorage.getItem("deals")) || [];
  let editingIndex = -1;

  function renderDeals() {
    dealTableBody.innerHTML = "";
    deals.forEach((deal, index) => {
      // Provide default values for missing properties
      const dealStage = deal.stage || '';
      const stageClass = dealStage ? dealStage.replace(/\s/g, '\\ ') : '';
      
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${deal.name || ''}</td>
        <td>${deal.customerNumber || ''}</td>
        <td>${deal.inquiryDate || ''}</td>
        <td>${deal.amount || ''}</td>
        <td><span class="stage-tag ${stageClass}">${dealStage}</span></td>
        <td>${deal.customer || ''}</td>
        <td>${deal.company || ''}</td>
        <td>${deal.email || ''}</td>
        <td>${deal.phone || ''}</td>
        <td>${deal.source || ''}</td>
        <td>${deal.product || ''}</td>
        <td>${deal.brand || ''}</td>
        <td>${deal.followUpPhone || ''}</td>       
        <td>${deal.followUpEmail || ''}</td>       
        <td>${deal.quotationDate || ''}</td>  
        <td class="action-buttons">
          <button class="edit-btn" data-index="${index}">Edit</button>
          <button class="delete-btn" data-index="${index}">Delete</button>
        </td>
      `;
      dealTableBody.appendChild(row);
    });
    addRowEvents();
  }

  function saveDeals() {
    localStorage.setItem("deals", JSON.stringify(deals));
  }

  // Fixed form submission - works with both API and localStorage fallback
  dealForm.addEventListener("submit", async function (e) {
    e.preventDefault();

    const dealData = {
      name: document.getElementById("dealName").value.trim(),
      amount: document.getElementById("dealAmount").value.trim(),
      stage: document.getElementById("dealStage").value.trim(),
      customerNumber: document.getElementById("customerNumberInput").value.trim(),
      inquiryDate: document.getElementById("inquiryDateInput").value,
      customer: document.getElementById("customerNameInput").value.trim(),
      company: document.getElementById("companyNameInput").value.trim(),
      email: document.getElementById("emailInput").value.trim(),
      phone: document.getElementById("phoneInput").value.trim(),
      source: document.getElementById("sourceInput").value.trim(),
      product: document.getElementById("productInput").value.trim(),
      brand: document.getElementById("brandInput").value.trim(),
      followUpPhone: document.getElementById("followUpPhoneInput").value.trim(),
      followUpEmail: document.getElementById("followUpEmailInput").value.trim(),
      quotationDate: document.getElementById("quotationDate").value.trim()
    };

    if (editingIndex >= 0) {
      // Update existing deal
      deals[editingIndex] = dealData;
      editingIndex = -1;
      saveDeals();
      renderDeals();
      alert("‚úÖ Deal updated successfully!");
      dealForm.reset();
      return;
    }

    // Try to save to API first, fallback to localStorage
    try {
      const response = await fetch("/api/deals", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(dealData)
      });

      if (response.ok) {
        const result = await response.json();
        if (result && result._id) {
          // Add MongoDB deal to local array
          deals.push({
            ...dealData,
            _id: result._id
          });
          saveDeals();
          renderDeals();
          alert("‚úÖ Deal saved to database successfully!");
          dealForm.reset();
          return;
        }
      }
      throw new Error("API response not valid");
    } catch (error) {
      console.warn("API failed, saving to localStorage:", error);
      
      // Fallback to localStorage only
      deals.push(dealData);
      saveDeals();
      renderDeals();
      alert("‚úÖ Deal saved locally (API unavailable)!");
      dealForm.reset();
    }
  });

  function addRowEvents() {
    document.querySelectorAll(".edit-btn").forEach(button => {
      button.addEventListener("click", () => {
        const index = parseInt(button.getAttribute("data-index"));
        const deal = deals[index];
        document.getElementById("dealName").value = deal.name || '';
        document.getElementById("dealAmount").value = deal.amount || '';
        document.getElementById("dealStage").value = deal.stage || '';
        document.getElementById("customerNumberInput").value = deal.customerNumber || '';
        document.getElementById("inquiryDateInput").value = deal.inquiryDate || '';
        document.getElementById("customerNameInput").value = deal.customer || '';
        document.getElementById("companyNameInput").value = deal.company || '';
        document.getElementById("emailInput").value = deal.email || '';
        document.getElementById("phoneInput").value = deal.phone || '';
        document.getElementById("sourceInput").value = deal.source || '';
        document.getElementById("productInput").value = deal.product || '';
        document.getElementById("brandInput").value = deal.brand || '';
        document.getElementById("followUpPhoneInput").value = deal.followUpPhone || '';
        document.getElementById("followUpEmailInput").value = deal.followUpEmail || '';
        document.getElementById("quotationDate").value = deal.quotationDate || '';

        editingIndex = index;
      });
    });

    document.querySelectorAll(".delete-btn").forEach(button => {
      button.addEventListener("click", () => {
        const index = parseInt(button.getAttribute("data-index"));
        if (confirm("Are you sure you want to delete this deal?")) {
          deals.splice(index, 1);
          saveDeals();
          renderDeals();
        }
      });
    });
  }

  // CSV Import/Export Functions
  function exportCSV() {
    if (deals.length === 0) {
      alert("‚ö†Ô∏è No deals to export!");
      return;
    }

    // Define CSV headers
    const headers = [
      'Deal Name', 'Customer Number', 'Inquiry Date', 'Amount', 'Stage',
      'Customer', 'Company', 'Email', 'Phone', 'Source', 'Product', 'Brand',
      'Follow Up Phone', 'Follow Up Email', 'Quotation Date'
    ];

    // Convert deals to CSV format
    const csvContent = [
      headers.join(','),
      ...deals.map(deal => [
        `"${(deal.name || '').replace(/"/g, '""')}"`,
        `"${(deal.customerNumber || '').replace(/"/g, '""')}"`,
        `"${(deal.inquiryDate || '').replace(/"/g, '""')}"`,
        `"${(deal.amount || '').replace(/"/g, '""')}"`,
        `"${(deal.stage || '').replace(/"/g, '""')}"`,
        `"${(deal.customer || '').replace(/"/g, '""')}"`,
        `"${(deal.company || '').replace(/"/g, '""')}"`,
        `"${(deal.email || '').replace(/"/g, '""')}"`,
        `"${(deal.phone || '').replace(/"/g, '""')}"`,
        `"${(deal.source || '').replace(/"/g, '""')}"`,
        `"${(deal.product || '').replace(/"/g, '""')}"`,
        `"${(deal.brand || '').replace(/"/g, '""')}"`,
        `"${(deal.followUpPhone || '').replace(/"/g, '""')}"`,
        `"${(deal.followUpEmail || '').replace(/"/g, '""')}"`,
        `"${(deal.quotationDate || '').replace(/"/g, '""')}"`
      ].join(','))
    ].join('\n');

    // Create and download file
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.setAttribute('href', url);
    link.setAttribute('download', `deals_export_${new Date().toISOString().split('T')[0]}.csv`);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    alert(`‚úÖ Exported ${deals.length} deals to CSV file!`);
  }

  function importCSV() {
    const fileInput = document.getElementById('csvFileInput');
    const file = fileInput.files[0];
    
    if (!file) {
      alert("‚ö†Ô∏è Please select a CSV file first!");
      return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const csv = e.target.result;
        const lines = csv.split('\n').filter(line => line.trim());
        
        if (lines.length < 2) {
          alert("‚ö†Ô∏è CSV file appears to be empty or invalid!");
          return;
        }

        // Parse header row
        const headers = lines[0].split(',').map(h => h.replace(/"/g, '').trim());
        
        // Expected headers mapping
        const headerMap = {
          'Deal Name': 'name',
          'Customer Number': 'customerNumber',
          'Inquiry Date': 'inquiryDate',
          'Amount': 'amount',
          'Stage': 'stage',
          'Customer': 'customer',
          'Company': 'company',
          'Email': 'email',
          'Phone': 'phone',
          'Source': 'source',
          'Product': 'product',
          'Brand': 'brand',
          'Follow Up Phone': 'followUpPhone',
          'Follow Up Email': 'followUpEmail',
          'Quotation Date': 'quotationDate'
        };

        const importedDeals = [];
        let successCount = 0;
        let errorCount = 0;

        // Parse data rows
        for (let i = 1; i < lines.length; i++) {
          try {
            const values = parseCSVLine(lines[i]);
            const deal = {};
            
            headers.forEach((header, index) => {
              const fieldName = headerMap[header];
              if (fieldName && values[index] !== undefined) {
                deal[fieldName] = values[index].replace(/"/g, '').trim();
              }
            });

            // Validate required fields
            if (deal.name && deal.stage) {
              importedDeals.push(deal);
              successCount++;
            } else {
              errorCount++;
              console.warn(`Row ${i + 1}: Missing required fields (name or stage)`);
            }
          } catch (error) {
            errorCount++;
            console.error(`Error parsing row ${i + 1}:`, error);
          }
        }

        if (importedDeals.length > 0) {
          // Ask user if they want to replace or append
          const replace = confirm(
            `Found ${importedDeals.length} valid deals to import.\n\n` +
            `Click OK to REPLACE existing deals, or Cancel to ADD to existing deals.`
          );

          if (replace) {
            deals = importedDeals;
          } else {
            deals = deals.concat(importedDeals);
          }

          saveDeals();
          renderDeals();
          
          alert(
            `‚úÖ Import completed!\n` +
            `‚Ä¢ Successfully imported: ${successCount} deals\n` +
            `‚Ä¢ Errors/Skipped: ${errorCount} rows\n` +
            `‚Ä¢ Total deals now: ${deals.length}`
          );
        } else {
          alert("‚ùå No valid deals found in the CSV file!");
        }

        // Reset file input
        fileInput.value = '';
        document.getElementById('importBtn').disabled = true;
        document.getElementById('fileInfo').textContent = '';

      } catch (error) {
        console.error('CSV Import Error:', error);
        alert("‚ùå Error reading CSV file. Please check the file format.");
      }
    };

    reader.readAsText(file);
  }

  // Helper function to parse CSV line with proper quote handling
  function parseCSVLine(line) {
    const result = [];
    let current = '';
    let inQuotes = false;
    
    for (let i = 0; i < line.length; i++) {
      const char = line[i];
      
      if (char === '"') {
        if (inQuotes && line[i + 1] === '"') {
          current += '"';
          i++; // Skip next quote
        } else {
          inQuotes = !inQuotes;
        }
      } else if (char === ',' && !inQuotes) {
        result.push(current);
        current = '';
      } else {
        current += char;
      }
    }
    
    result.push(current);
    return result;
  }

  function clearAllDeals() {
    if (deals.length === 0) {
      alert("‚ö†Ô∏è No deals to clear!");
      return;
    }

    const confirmed = confirm(
      `‚ö†Ô∏è Are you sure you want to delete ALL ${deals.length} deals?\n\n` +
      "This action cannot be undone!"
    );

    if (confirmed) {
      deals = [];
      saveDeals();
      renderDeals();
      alert("‚úÖ All deals have been cleared!");
    }
  }

  // File input change handler
  document.addEventListener('DOMContentLoaded', function() {
    const fileInput = document.getElementById('csvFileInput');
    const importBtn = document.getElementById('importBtn');
    const fileInfo = document.getElementById('fileInfo');

    if (fileInput) {
      fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          if (file.type === 'text/csv' || file.name.toLowerCase().endsWith('.csv')) {
            importBtn.disabled = false;
            importBtn.style.opacity = '1';
            fileInfo.textContent = `Selected: ${file.name} (${(file.size / 1024).toFixed(1)} KB)`;
            fileInfo.style.color = '#28a745';
          } else {
            importBtn.disabled = true;
            importBtn.style.opacity = '0.6';
            fileInfo.textContent = 'Please select a valid CSV file';
            fileInfo.style.color = '#dc3545';
          }
        } else {
          importBtn.disabled = true;
          importBtn.style.opacity = '0.6';
          fileInfo.textContent = '';
        }
      });
    }
  });

  window.onload = function () {
    // Autofill from URL params
    const params = new URLSearchParams(window.location.search);
    const fields = {
      customerNumberInput: "number",
      inquiryDateInput: "inquiryDate",
      customerNameInput: "name",
      companyNameInput: "company",
      emailInput: "email",
      phoneInput: "phone",
      sourceInput: "source",
      productInput: "product",
      brandInput: "brand",
    };

    for (const [inputId, paramName] of Object.entries(fields)) {
      const value = params.get(paramName);
      if (value) {
        const input = document.getElementById(inputId);
        if (input) input.value = decodeURIComponent(value);
      }
    }

    const customerName = params.get("name");
    const customerNumber = params.get("number");

    if (customerName && customerNumber) {
      document.getElementById("customerDetails").innerHTML =
        `Selected Lead: <strong>${customerName}</strong> (Customer #${customerNumber})`;
    }

    renderDeals();
  };
</script>
<script>
  flatpickr(".flatpickr-datetime", {
    enableTime: true,
    dateFormat: "m/d/Y, h:i K",  // Internal value format
    altInput: true,
    altFormat: "m/d/Y, h:i K" ,  // Display format for users
    minuteIncrement: 1  
  });
  flatpickr("#quotationDate", {
    enableTime: true,
    dateFormat: "Y-m-d h:i K", // 12-hour format with AM/PM
    altInput: true,
    altFormat: "F j, Y h:i K",
    minuteIncrement: 1
  });
</script>
</body>
</html>